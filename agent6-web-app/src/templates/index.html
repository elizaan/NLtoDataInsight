<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animation Assistant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Left Panel: Chat Interface -->
        <div class="chat-panel">
            <div class="chat-header">
                <h2><i class="fas fa-water"></i> NLtoAnimation - Animation Scripting Agent</h2>
                <p>Your AI guide for creating animations</p>
                <!-- LangChain toggle: allows opting into LangChain orchestration from the UI -->
                <div style="margin-top:8px;">
                    <label style="font-size:0.9em;">
                        <input type="checkbox" id="useLangChainToggle" />
                        <strong>Use LangChain orchestration</strong> (opt-in)
                    </label>
                </div>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message bot-message">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <p>Welcome! I'm your animation agent. Let's create animation of what you want to visualize.</p>
                        <p>First, let's select a dataset. You can:</p>
                        <div class="option-buttons">
                            <button class="option-btn" onclick="selectDataset('available')">
                                <i class="fas fa-database"></i> Use Available Dataset
                            </button>
                            <!-- Upload option temporarily disabled per user request
                            <button class="option-btn" onclick="selectDataset('upload')">
                                <i class="fas fa-upload"></i> Upload Your Dataset
                            </button>
                            -->
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="dataset-selection" id="datasetSelection" style="display: none;">
                    <div class="available-datasets">
                        <div id="available-datasets-list"></div>
                    </div>
                    <div id="datasetSummaryContainer" style="display:none;"></div>
            </div>
            
            <div class="phenomenon-selection" id="phenomenonSelection" style="display: none;">
                <div class="message bot-message">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <p>Great! Now, what oceanographic phenomenon would you like to visualize?</p>
                        <div class="phenomenon-options">
                            <button class="phenomenon-btn" onclick="selectPhenomenon('1')">
                                <i class="fas fa-thermometer-half"></i>
                                <span>Agulhas Ring Current - Temperature</span>
                            </button>
                            <button class="phenomenon-btn" onclick="selectPhenomenon('2')">
                                <i class="fas fa-tint"></i>
                                <span>Agulhas Ring Current - Salinity with Streamlines</span>
                            </button>
                            <button class="phenomenon-btn" onclick="selectPhenomenon('3')">
                                <i class="fas fa-thermometer-half"></i>
                                <span>Mediterranean Sea Current - Temperature</span>
                            </button>
                            <button class="phenomenon-btn" onclick="selectPhenomenon('4')">
                                <i class="fas fa-tint"></i>
                                <span>Mediterranean Sea Current - Salinity with Streamlines</span>
                            </button>
                            <button class="phenomenon-btn" onclick="selectPhenomenon('custom')">
                                <i class="fas fa-edit"></i>
                                <span>Custom Description</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="custom-input" id="customInput" style="display: none;">
                <div class="input-container">
                    <textarea id="customDescription" placeholder="Describe the oceanographic phenomenon you want to visualize..." rows="3"></textarea>
                    <button onclick="submitCustomDescription()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            
            <div class="chat-input-container" id="chatInputContainer" style="display: none;">
                <div class="input-container">
                    <input type="text" id="chatInput" placeholder="Ask me anything about your animation..." />
                    <button onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Resize Handle -->
        <div class="resize-handle" id="resizeHandle"></div>
        
        <!-- Right Panel: Multi-Panel Animation Display -->
        <div class="animation-panel">
            <div class="animation-header">
                <h3 id="animationTitle">Animation Panel</h3>
                <div class="animation-status" id="animationStatus">
                    <span class="status-indicator"></span>
                    <span>Ready</span>
                </div>
            </div>
            
            <!-- Multi-panel grid container -->
            <div class="animation-grid" id="animationGrid">
                <!-- Placeholder shown when no animations -->
                <div class="animation-placeholder" id="gridPlaceholder">
                    
                </div>
                
                <!-- ========== TEST DUMMY PANELS - COMMENTED OUT ==========
                UNCOMMENT BELOW TO TEST MULTI-PANEL LAYOUT WITHOUT REAL ANIMATIONS
                Change class above to: class="animation-grid panel-count-4"
                
                <div class="animation-panel-item">
                    <div class="panel-header">
                        <h4 class="panel-title">Test Animation #1 - Temperature</h4>
                        <div class="panel-actions">
                            <button class="panel-action-btn">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button class="panel-action-btn">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <div class="panel-viewer">
                        <canvas class="panel-canvas" id="test-canvas-1" width="800" height="600" style="background: linear-gradient(to bottom, #8B4513 0%, #8B4513 20%, #1e3a5f 20%, #1e3a5f 40%, #2c5f8d 40%, #2c5f8d 100%);"></canvas>
                    </div>
                    <div class="panel-controls">
                        <div class="panel-control-buttons">
                            <button class="panel-control-btn">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-stop"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-step-backward"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-step-forward"></i>
                            </button>
                        </div>
                        <div class="panel-progress">
                            <input type="range" min="0" max="100" value="50">
                            <span class="panel-frame-info">Frame 5 / 10</span>
                        </div>
                    </div>
                </div>
                
                <div class="animation-panel-item">
                    <div class="panel-header">
                        <h4 class="panel-title">Test Animation #2 - Salinity</h4>
                        <div class="panel-actions">
                            <button class="panel-action-btn">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button class="panel-action-btn">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <div class="panel-viewer">
                        <canvas class="panel-canvas" id="test-canvas-2" width="800" height="600" style="background: linear-gradient(to bottom, #654321 0%, #654321 20%, #0f4c5c 20%, #0f4c5c 40%, #1b7f8e 40%, #1b7f8e 100%);"></canvas>
                    </div>
                    <div class="panel-controls">
                        <div class="panel-control-buttons">
                            <button class="panel-control-btn">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-stop"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-step-backward"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-step-forward"></i>
                            </button>
                        </div>
                        <div class="panel-progress">
                            <input type="range" min="0" max="100" value="30">
                            <span class="panel-frame-info">Frame 3 / 10</span>
                        </div>
                    </div>
                </div>
                
                <div class="animation-panel-item">
                    <div class="panel-header">
                        <h4 class="panel-title">Test Animation #3 - Velocity</h4>
                        <div class="panel-actions">
                            <button class="panel-action-btn">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button class="panel-action-btn">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <div class="panel-viewer">
                        <canvas class="panel-canvas" id="test-canvas-3" width="800" height="600" style="background: linear-gradient(to bottom, #704214 0%, #704214 20%, #1a4d2e 20%, #1a4d2e 40%, #27ae60 40%, #27ae60 100%);"></canvas>
                    </div>
                    <div class="panel-controls">
                        <div class="panel-control-buttons">
                            <button class="panel-control-btn">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-stop"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-step-backward"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-step-forward"></i>
                            </button>
                        </div>
                        <div class="panel-progress">
                            <input type="range" min="0" max="100" value="75">
                            <span class="panel-frame-info">Frame 8 / 10</span>
                        </div>
                    </div>
                </div>
                
                <div class="animation-panel-item">
                    <div class="panel-header">
                        <h4 class="panel-title">Test Animation #4 - Depth</h4>
                        <div class="panel-actions">
                            <button class="panel-action-btn">
                                <i class="fas fa-expand"></i>
                            </button>
                            <button class="panel-action-btn">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <div class="panel-viewer">
                        <canvas class="panel-canvas" id="test-canvas-4" width="800" height="600" style="background: linear-gradient(to bottom, #5d4037 0%, #5d4037 20%, #4a148c 20%, #4a148c 40%, #9c27b0 40%, #9c27b0 100%);"></canvas>
                    </div>
                    <div class="panel-controls">
                        <div class="panel-control-buttons">
                            <button class="panel-control-btn">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-stop"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-step-backward"></i>
                            </button>
                            <button class="panel-control-btn">
                                <i class="fas fa-step-forward"></i>
                            </button>
                        </div>
                        <div class="panel-progress">
                            <input type="range" min="0" max="100" value="90">
                            <span class="panel-frame-info">Frame 9 / 10</span>
                        </div>
                    </div>
                </div>
                ========== END TEST DUMMY PANELS ========== -->
            </div>
            
            <!-- Hidden: Legacy single-panel support (kept for backward compatibility) -->
            <div class="animation-viewer" id="animationViewer" style="display: none;">
                <canvas id="animationCanvas" style="display: none;"></canvas>
                <img id="animationPreview" style="display: none;" />
                
                <div class="animation-controls" id="animationControls" style="display: none;">
                    <div class="control-buttons">
                        <button id="playPauseBtn" onclick="togglePlayPause()">
                            <i class="fas fa-play"></i>
                        </button>
                        <button id="stopBtn" onclick="stopAnimation()">
                            <i class="fas fa-stop"></i>
                        </button>
                        <button id="prevBtn" onclick="previousFrame()">
                            <i class="fas fa-step-backward"></i>
                        </button>
                        <button id="nextBtn" onclick="nextFrame()">
                            <i class="fas fa-step-forward"></i>
                        </button>
                    </div>
                    
                    <div class="progress-container">
                        <input type="range" id="progressSlider" min="0" max="100" value="0" />
                        <span id="frameInfo">Frame 0 / 0</span>
                    </div>
                    
                    <div class="speed-control">
                        <label>Speed:</label>
                        <input type="range" id="speedSlider" min="0.5" max="2" step="0.1" value="1" />
                        <span id="speedLabel">1.0x</span>
                    </div>
                    
                    <div class="export-controls">
                        <button id="exportBtn" onclick="exportAnimation()">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                </div>
            </div>
                
                <!-- System Logs Section -->
                <div class="system-logs" id="systemLogs">
                    <div class="logs-resize-handle" id="logsResizeHandle"></div>
                    <div class="logs-header">
                        <h4><i class="fas fa-terminal"></i> System Logs</h4>
                        <div class="logs-controls">
                            <button id="clearLogsBtn" onclick="clearSystemLogs()">
                                <i class="fas fa-trash"></i> Clear
                            </button>
                            <button id="toggleLogsBtn" onclick="toggleLogsSize()" class="toggle-button" title="Minimize logs">
                                <i class="fas fa-minus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="logs-content" id="logsContent">
                        <div class="log-placeholder">
                            <i class="fas fa-info-circle"></i>
                            <p>System logs will appear here during animation generation</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
                <textarea id="custom-description" name="custom_description" placeholder="Enter your description here..."></textarea>
                
                <button type="submit">Generate Animation</button>
            </form>
        </section>
        <section id="results">
            <h2>Results</h2>
            <div id="output"></div>
        </section>
    </main>
        <footer>
        <p>&copy; 2025 Agent6 Web Application. All rights reserved.</p>
    </footer>
    <script src="{{ url_for('static', filename='js/chat.js') }}?v=20251105_2145_dynamic_padding"></script>
</body>
</html>
```